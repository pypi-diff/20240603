# Comparing `tmp/rqdatac-3.0.7.1-cp39-cp39-win_amd64.whl.zip` & `tmp/rqdatac-3.0.8-cp39-cp39-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,15 +1,15 @@
-Zip file size: 302520 bytes, number of entries: 52
+Zip file size: 302660 bytes, number of entries: 52
 -rw-rw-rw-  2.0 fat      967 b- defN 23-Dec-01 07:07 rqdatac/__init__.py
 -rw-rw-rw-  2.0 fat    10668 b- defN 24-Mar-29 02:50 rqdatac/__init__.pyi
 -rw-rw-rw-  2.0 fat      934 b- defN 23-Dec-01 07:07 rqdatac/_internal.py
--rw-rw-rw-  2.0 fat      520 b- defN 24-May-21 09:49 rqdatac/_version.py
+-rw-rw-rw-  2.0 fat      518 b- defN 24-May-31 09:11 rqdatac/_version.py
 -rw-rw-rw-  2.0 fat    10387 b- defN 23-Dec-22 06:50 rqdatac/client.py
--rw-rw-rw-  2.0 fat   139776 b- defN 24-May-21 09:49 rqdatac/connection.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat   768200 b- defN 24-May-21 09:49 rqdatac/connection.cpp
+-rw-rw-rw-  2.0 fat   139776 b- defN 24-May-31 09:11 rqdatac/connection.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat   768200 b- defN 24-May-31 09:11 rqdatac/connection.cpp
 -rw-rw-rw-  2.0 fat     2239 b- defN 23-Dec-01 07:07 rqdatac/connection_pool.py
 -rw-rw-rw-  2.0 fat     4447 b- defN 23-Dec-01 07:07 rqdatac/decorators.py
 -rw-rw-rw-  2.0 fat     3072 b- defN 23-Dec-01 07:07 rqdatac/rqdatah_helper.py
 -rw-rw-rw-  2.0 fat     2140 b- defN 23-Dec-01 07:07 rqdatac/thread_local.py
 -rw-rw-rw-  2.0 fat    10929 b- defN 24-Apr-29 06:08 rqdatac/utils.py
 -rw-rw-rw-  2.0 fat     9265 b- defN 24-Jan-12 06:37 rqdatac/validators.py
 -rw-rw-rw-  2.0 fat        0 b- defN 23-Dec-01 07:07 rqdatac/services/__init__.py
@@ -19,23 +19,23 @@
 -rw-rw-rw-  2.0 fat     2470 b- defN 23-Dec-01 07:07 rqdatac/services/concept.py
 -rw-rw-rw-  2.0 fat    47501 b- defN 24-Apr-16 06:15 rqdatac/services/consensus.py
 -rw-rw-rw-  2.0 fat    10141 b- defN 23-Dec-01 07:07 rqdatac/services/constant.py
 -rw-rw-rw-  2.0 fat    29339 b- defN 24-Mar-29 02:50 rqdatac/services/convertible.py
 -rw-rw-rw-  2.0 fat     2405 b- defN 23-Dec-01 07:07 rqdatac/services/extra.py
 -rw-rw-rw-  2.0 fat    33958 b- defN 24-Mar-29 02:50 rqdatac/services/factor.py
 -rw-rw-rw-  2.0 fat    12561 b- defN 24-Apr-29 06:08 rqdatac/services/financial.py
--rw-rw-rw-  2.0 fat    33768 b- defN 24-Apr-16 06:15 rqdatac/services/future.py
--rw-rw-rw-  2.0 fat    13532 b- defN 24-Apr-29 06:08 rqdatac/services/get_capital_flow.py
+-rw-rw-rw-  2.0 fat    33826 b- defN 24-May-31 09:10 rqdatac/services/future.py
+-rw-rw-rw-  2.0 fat    13722 b- defN 24-May-31 09:10 rqdatac/services/get_capital_flow.py
 -rw-rw-rw-  2.0 fat    29756 b- defN 24-Mar-15 05:59 rqdatac/services/get_price.py
 -rw-rw-rw-  2.0 fat     8880 b- defN 24-Mar-15 05:59 rqdatac/services/index.py
 -rw-rw-rw-  2.0 fat     6473 b- defN 24-Apr-29 06:08 rqdatac/services/ksh_auction_info.py
 -rw-rw-rw-  2.0 fat    15816 b- defN 23-Dec-01 07:07 rqdatac/services/live.py
 -rw-rw-rw-  2.0 fat    17180 b- defN 23-Dec-01 07:07 rqdatac/services/live_md_client.py
 -rw-rw-rw-  2.0 fat    20995 b- defN 24-May-16 09:39 rqdatac/services/market_data.py
--rw-rw-rw-  2.0 fat    14163 b- defN 24-May-21 09:49 rqdatac/services/options.py
+-rw-rw-rw-  2.0 fat    14493 b- defN 24-May-31 09:10 rqdatac/services/options.py
 -rw-rw-rw-  2.0 fat     9995 b- defN 23-Dec-01 07:07 rqdatac/services/shenwan.py
 -rw-rw-rw-  2.0 fat    29976 b- defN 24-Feb-23 09:49 rqdatac/services/stock_status.py
 -rw-rw-rw-  2.0 fat     2310 b- defN 23-Dec-01 07:07 rqdatac/services/structured_fund.py
 -rw-rw-rw-  2.0 fat     2268 b- defN 23-Dec-01 07:07 rqdatac/services/tmall.py
 -rw-rw-rw-  2.0 fat     3649 b- defN 23-Dec-01 07:07 rqdatac/services/xueqiu.py
 -rw-rw-rw-  2.0 fat       61 b- defN 23-Dec-01 07:07 rqdatac/services/detail/__init__.py
 -rw-rw-rw-  2.0 fat     5733 b- defN 23-Dec-01 07:07 rqdatac/services/detail/adjust_price.py
@@ -43,12 +43,12 @@
 -rw-rw-rw-  2.0 fat     1833 b- defN 23-Dec-01 07:07 rqdatac/services/detail/resample_helper.py
 -rw-rw-rw-  2.0 fat       16 b- defN 23-Dec-01 07:07 rqdatac/services/orm/__init__.py
 -rw-rw-rw-  2.0 fat    12814 b- defN 23-Dec-01 07:07 rqdatac/services/orm/pit_financials_ex.py
 -rw-rw-rw-  2.0 fat        0 b- defN 23-Dec-01 07:07 rqdatac/share/__init__.py
 -rw-rw-rw-  2.0 fat     5289 b- defN 23-Dec-01 07:07 rqdatac/share/codec.py
 -rw-rw-rw-  2.0 fat     1728 b- defN 23-Dec-01 07:07 rqdatac/share/errors.py
 -rw-rw-rw-  2.0 fat     1817 b- defN 23-Dec-01 07:07 rqdatac/share/protocol.py
--rw-rw-rw-  2.0 fat     2519 b- defN 24-May-21 09:49 rqdatac-3.0.7.1.dist-info/METADATA
--rw-rw-rw-  2.0 fat      100 b- defN 24-May-21 09:49 rqdatac-3.0.7.1.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        8 b- defN 24-May-21 09:49 rqdatac-3.0.7.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     4390 b- defN 24-May-21 09:49 rqdatac-3.0.7.1.dist-info/RECORD
-52 files, 1448919 bytes uncompressed, 295598 bytes compressed:  79.6%
+-rw-rw-rw-  2.0 fat     2517 b- defN 24-May-31 09:11 rqdatac-3.0.8.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      100 b- defN 24-May-31 09:11 rqdatac-3.0.8.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        8 b- defN 24-May-31 09:11 rqdatac-3.0.8.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     4382 b- defN 24-May-31 09:11 rqdatac-3.0.8.dist-info/RECORD
+52 files, 1449485 bytes uncompressed, 295754 bytes compressed:  79.6%
```

## zipnote {}

```diff
@@ -138,20 +138,20 @@
 
 Filename: rqdatac/share/errors.py
 Comment: 
 
 Filename: rqdatac/share/protocol.py
 Comment: 
 
-Filename: rqdatac-3.0.7.1.dist-info/METADATA
+Filename: rqdatac-3.0.8.dist-info/METADATA
 Comment: 
 
-Filename: rqdatac-3.0.7.1.dist-info/WHEEL
+Filename: rqdatac-3.0.8.dist-info/WHEEL
 Comment: 
 
-Filename: rqdatac-3.0.7.1.dist-info/top_level.txt
+Filename: rqdatac-3.0.8.dist-info/top_level.txt
 Comment: 
 
-Filename: rqdatac-3.0.7.1.dist-info/RECORD
+Filename: rqdatac-3.0.8.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## rqdatac/_version.py

```diff
@@ -4,18 +4,18 @@
 # unpacked source archive. Distribution tarballs contain a pre-generated copy
 # of this file.
 
 import json
 
 version_json = '''
 {
- "date": "2024-05-21T17:47:38+0800",
+ "date": "2024-05-31T17:09:18+0800",
  "dirty": false,
  "error": null,
- "full-revisionid": "d7fb4192e172f25e72d55a5dcc1fd974cfe2e1ae",
- "version": "3.0.7.1"
+ "full-revisionid": "faf3cc0e1dd455482bb380d9995f7f433dba6862",
+ "version": "3.0.8"
 }
 '''  # END VERSION_JSON
 
 
 def get_versions():
     return json.loads(version_json)
```

## rqdatac/services/future.py

```diff
@@ -452,14 +452,16 @@
         if frequency == '1d':
             from rqdatac.services.detail import get_price_df
             index_close = get_price_df.get_future_indx_daybar(underlying_ids, start_date, end_date, fields=["close"])
             date_field = 'date'
         else:
             index_close = get_price.get_price(underlying_ids, start_date, end_date, frequency=frequency, fields=close_field, expect_df=True)
             date_field = 'datetime'
+        if index_close is None:
+            return None
         index_close.columns = ['close_index']
         future_price = pd.merge_asof(
             future_price.reset_index().sort_values(date_field),
             index_close.reset_index().rename(
                 columns={'order_book_id': 'index'}
             ).sort_values(date_field),
             on=date_field,
```

## rqdatac/services/get_capital_flow.py

```diff
@@ -299,21 +299,26 @@
             del df["date"]
     else:
         df = None
 
     if start_date > live_date or end_date < live_date:
         return df
 
+    def _trading_date_of(dt):
+        if 8 < dt.hour < 18:
+            return date_to_int8(dt)
+        return date_to_int8(get_next_trading_date(dt - datetime.timedelta(hours=4)))
+
     if df is not None:
         idx = df.index
         for ob in idx.levels[0]:
             if ob not in live_obs:
                 continue
             loc = idx.get_loc(ob)
-            if date_to_int8(idx[loc.stop - 1][-1]) == live_date:
+            if _trading_date_of(idx[loc.stop - 1][-1]) == live_date:
                 live_obs.remove(ob)
 
     if not live_obs:
         return df
 
     try:
         live_df = get_today_auction(list(live_obs), auction_type, live_date, market=market)
```

## rqdatac/services/options.py

```diff
@@ -1,8 +1,9 @@
 # -*- coding: utf-8 -*-
+import warnings
 import datetime
 
 import numpy as np
 import pandas as pd
 
 from rqdatac.validators import (
     check_items_in_container,
@@ -15,16 +16,17 @@
 )
 
 from rqdatac.client import get_client
 from rqdatac.decorators import export_as_api
 from rqdatac.services.calendar import current_trading_date, get_trading_dates
 from rqdatac.services.basic import all_instruments, instruments
 from rqdatac.services.get_price import get_price
-from rqdatac.utils import is_panel_removed, convert_bar_to_multi_df, int14_to_datetime_v
+from rqdatac.utils import is_panel_removed, convert_bar_to_multi_df, int14_to_datetime_v, date_to_int8
 from rqdatac.rqdatah_helper import rqdatah_serialize, http_conv_list_to_csv
+from rqdatac.share.errors import PermissionDenied, MarketNotSupportError, NoSuchService
 
 VALID_GREEKS_FIELDS = ['iv', 'delta', 'gamma', 'vega', 'theta', 'rho']
 
 
 def get_greeks_min(order_book_ids, start_date, end_date, fields, model, market):
     live_date = current_trading_date()
     if start_date > live_date:
@@ -51,22 +53,25 @@
             if date_to_int8(idx[loc.stop - 1][-1]) == live_date:
                 live_obs.remove(ob)
     if not live_obs:
         return df
 
     live_df = None
     if end_date >= live_date:
-        live_data = get_client().execute('options.get_live_greeks_min', list(live_obs), model, market)
-        live_dfs = [pd.DataFrame(d) for d in live_data if d]
-        if live_dfs:
-            live_df = pd.concat(live_dfs)
-            live_df['datetime'] = int14_to_datetime_v(live_df['datetime'])
-            live_df.set_index(['order_book_id', 'datetime'], inplace=True)
-        if live_df is None:
-            return df
+        try:
+            live_data = get_client().execute('options.get_live_greeks_min', list(live_obs), model, market)
+            live_dfs = [pd.DataFrame(d) for d in live_data if d]
+            if live_dfs:
+                live_df = pd.concat(live_dfs)
+                live_df['datetime'] = int14_to_datetime_v(live_df['datetime'])
+                live_df.set_index(['order_book_id', 'datetime'], inplace=True)
+            if live_df is None:
+                return df
+        except (PermissionDenied, MarketNotSupportError, NoSuchService) as e:
+            warnings.warn("Error when get realtime minbar option greeks: {}".format(e))
     if df is None:
         return live_df
     df = pd.concat([df, live_df])
     df.sort_index(inplace=True)
     return df
 
 
@@ -321,15 +326,15 @@
     if end_date < start_date:
         raise ValueError("invalid date range: [{!r}, {!r}]".format(start_date, end_date))
 
     result = get_client().execute('options.get_dominant_month', underlying_symbol, start_date, end_date, rule, market=market)
 
     if not result:
         return
-    
+
     df = pd.DataFrame(result)
     df = df.set_index('date')
     return df.sort_index()['dominant']
 
 
 @export_as_api(namespace='options')
 def get_commission(underlying_symbols, market='cn'):
```

## Comparing `rqdatac-3.0.7.1.dist-info/METADATA` & `rqdatac-3.0.8.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: rqdatac
-Version: 3.0.7.1
+Version: 3.0.8
 Summary: Ricequant Data SDK
 Home-page: https://www.ricequant.com/doc/rqdata-institutional#research-version
 Author: Ricequant
 Author-email: public@ricequant.com
 License: UNKNOWN
 Download-URL: https://pypi.org/
 Platform: UNKNOWN
```

## Comparing `rqdatac-3.0.7.1.dist-info/RECORD` & `rqdatac-3.0.8.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 rqdatac/__init__.py,sha256=a0HbcG9uHohaM-skdDcCD1aTqou4KFAa5d9PLuzmN6I,967
 rqdatac/__init__.pyi,sha256=TySe_FcaM6CGIilA8xLtq3cgN4b1QYYmUtr69TM6_bs,10668
 rqdatac/_internal.py,sha256=abdi2JnDfRvt4JDIArQJuAYAgdKEwHV8ZtRAuw_fOR8,934
-rqdatac/_version.py,sha256=tthbMFsrLQxBKVAvPWvhvB3TWRRxmzg---brYyzz5wI,520
+rqdatac/_version.py,sha256=oQh16OCJvjYnTJsRJ9Vw3vmxNnzAHmrPtXxzbXFBCms,518
 rqdatac/client.py,sha256=pauqhPhvnY3bmWMMJ67e_DCqUdnWYL_s86lxTkGrStg,10387
-rqdatac/connection.cp39-win_amd64.pyd,sha256=NWKUmfIQKrWcfndTIcSGsaTN7_PnXahu-__asAdBqdA,139776
+rqdatac/connection.cp39-win_amd64.pyd,sha256=M53-dsonqim3HGqdfypfJR0m7LMOzdPRuv0-W4rYtOE,139776
 rqdatac/connection.cpp,sha256=KwiKuKOh7ZIelC1LncKMgskAN0_ml0GXD-SuA7thLp0,768200
 rqdatac/connection_pool.py,sha256=--mQnkbEFk0BbSsGpiHZKrijyut0niR4OsqGaR2-Y2U,2239
 rqdatac/decorators.py,sha256=cEGPnC2AlXHtt9Vsdxv7324beivEEYjMIFjv51EWZU0,4447
 rqdatac/rqdatah_helper.py,sha256=MmWLVsZ5ZiXcgs_cSeztZ2SL5F6R-bkh-f9LNBZiZMw,3072
 rqdatac/thread_local.py,sha256=ywvXoXa1L4LtFyAFBtEZGvkjvbPQFI-7Gb3mhxZXld8,2140
 rqdatac/utils.py,sha256=y9cOK2STswXy9eC-9309UKde7svzni1Jeoz_BtA-i2I,10929
 rqdatac/validators.py,sha256=lN3S7GXjJ-TLzfhVqj1UgEtcyK9Sm2E4uMoySFVWhzA,9265
@@ -18,23 +18,23 @@
 rqdatac/services/concept.py,sha256=l7dGWo6sMsnlyKQClRkMcaxlxOcIX7PoucvgV5MwBhI,2470
 rqdatac/services/consensus.py,sha256=N157k0uWkOowqcqgcX_KqV7BNYGbXFCRduNp267VaSY,47501
 rqdatac/services/constant.py,sha256=IbnKoILR2wXLoqcVJlFJdtMOnHzYhC2i06qfjPkSeCs,10141
 rqdatac/services/convertible.py,sha256=z_-2QrrqFQCz08OKjMgBATjkTKlevn7MDoLe7jv9oA8,29339
 rqdatac/services/extra.py,sha256=MXt5zBsRGitRIpDrT_IzLrIhAPnb99l-Wv7gXL90WZE,2405
 rqdatac/services/factor.py,sha256=TQCaP1LgQT6ZZvMZdopSfrU9993wBspB5kblwsRnXzY,33958
 rqdatac/services/financial.py,sha256=5gr9K2KjnOE1gkw3gAfVly3TGA20vYYp6BTLdJGIfJc,12561
-rqdatac/services/future.py,sha256=DTfSAdCbaPMnMyz52UrPHJc_O6xOFnNSc58UrpwGNFE,33768
-rqdatac/services/get_capital_flow.py,sha256=zDPF2hgN0u43bv88nn5rszKNY1yjHImmi6Q0x3lBA7c,13532
+rqdatac/services/future.py,sha256=IGe9RZId171bxvyVVc6Fqw9BB1rlhBheq0MlP2I8a2A,33826
+rqdatac/services/get_capital_flow.py,sha256=q3XSaNtOvidMElU6oOejv6piwiOVSiP2rl9LSZHJPz8,13722
 rqdatac/services/get_price.py,sha256=wk6zEvMioQmT6RryKTScWj5yAJVK6y5_qFJcCOUftK0,29756
 rqdatac/services/index.py,sha256=n_bXgktyxqE2RmXgjsxOM4lhzDyF1VbqZ7scDH9bvAI,8880
 rqdatac/services/ksh_auction_info.py,sha256=BAHp6f5DfuO3qwyylLWU6UO5ZW4ZARQuGPAXowpVJbI,6473
 rqdatac/services/live.py,sha256=fN2htMMevo8G7oxKU7xSUTLktcafEN2jgPSs4McbXGY,15816
 rqdatac/services/live_md_client.py,sha256=ZFH826cpE8Fq0nrld1_1ue29wNyz2TL6WriAM34puHI,17180
 rqdatac/services/market_data.py,sha256=wclRal_EomNyrNTgtaw1GTkb5EuibnJ6cj_G9kT_oL4,20995
-rqdatac/services/options.py,sha256=S9M_JPK2D-ektKfmh57XtjquyOztPzHZTX9YyKcVAZA,14163
+rqdatac/services/options.py,sha256=yAzCd1ocMq2CMIgGFgVG4HNDyc16L726mIEJqrcIKLI,14493
 rqdatac/services/shenwan.py,sha256=42LrrMfy8F20OgcdSxRcP62p6MHEMjl0Hq-LGKtmHRI,9995
 rqdatac/services/stock_status.py,sha256=1eJJOCeDeMnsTmQRWKGYjjO-EvxU2r7HTePgExp9Oi0,29976
 rqdatac/services/structured_fund.py,sha256=EuHPDy4x0yEhsa8UFmPquRkPYehT7vFMUdfStoCXH78,2310
 rqdatac/services/tmall.py,sha256=xnguR3EtsUgS2pOhuKSIntuYMD5Av0RQ43-o928E6oU,2268
 rqdatac/services/xueqiu.py,sha256=05EjY0arr3czJqcSW7eUaUNHLCg_oR-Op1dz2FnJAlY,3649
 rqdatac/services/detail/__init__.py,sha256=km3ukXA_kKk738F7IUc_8mjfC8xys_k0X7O4U1yu6KU,61
 rqdatac/services/detail/adjust_price.py,sha256=h96rZdV4BkUzXF6hfIz9fT1CBcJF5uCnFcXIbbK2hOg,5733
@@ -42,11 +42,11 @@
 rqdatac/services/detail/resample_helper.py,sha256=EjcyKO3l4exvS8i8DAre6NdlrX27o4m0k8lHFgd8C6c,1833
 rqdatac/services/orm/__init__.py,sha256=ely2PttjgSv7vKdzskuD1rtK_l_UOpmxJSz8isrveD0,16
 rqdatac/services/orm/pit_financials_ex.py,sha256=igBoSVTivx7AT8ogsDlI8rl7kLHg3VE62AoXGRbaUtw,12814
 rqdatac/share/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 rqdatac/share/codec.py,sha256=KYSRcPif3xqXzKVkiXxBwesLuA0THBmuOhBmudKpe3k,5289
 rqdatac/share/errors.py,sha256=BBBnwcxoSRRnxDfGPCBF9UNh0mEe2AI6PISjlBWnSg4,1728
 rqdatac/share/protocol.py,sha256=Gmx2kC04hfqZhsy6EqmxM_y_UWu6k7B9TCRpHzMpP5o,1817
-rqdatac-3.0.7.1.dist-info/METADATA,sha256=9QvrAtna204Bn9XFSf_UG3qelvPXjjEp1zX6K6LG6sw,2519
-rqdatac-3.0.7.1.dist-info/WHEEL,sha256=jr7ubY0Lkz_yXH9FfFe9PTtLhGOsf62dZkNvTYrJINE,100
-rqdatac-3.0.7.1.dist-info/top_level.txt,sha256=I8Iv5zqeIYph4_6GREZAPsFzfVvodVwdc-ZHdtjJWCY,8
-rqdatac-3.0.7.1.dist-info/RECORD,,
+rqdatac-3.0.8.dist-info/METADATA,sha256=QgieKWUFda6KP1Bk8fcPJWRgrbcjpp9m_wj9SPk9zhg,2517
+rqdatac-3.0.8.dist-info/WHEEL,sha256=jr7ubY0Lkz_yXH9FfFe9PTtLhGOsf62dZkNvTYrJINE,100
+rqdatac-3.0.8.dist-info/top_level.txt,sha256=I8Iv5zqeIYph4_6GREZAPsFzfVvodVwdc-ZHdtjJWCY,8
+rqdatac-3.0.8.dist-info/RECORD,,
```

